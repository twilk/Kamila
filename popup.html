<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAMILA</title>
    <link href="lib/bootstrap.min.css" rel="stylesheet">
    <link href="styles/theme.css" rel="stylesheet">
    <link href="styles/animations.css" rel="stylesheet">
    <link href="styles/style.css" rel="stylesheet">
    <link href="styles/performance-panel.css" rel="stylesheet">
    <link href="styles/content.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <style>
        html {
            border-radius: 12px;
            overflow: hidden;
        }
    </style>
</head>
<body style="width: 800px; height: 600px; margin: 0; padding: 0;">
    <div class="container-fluid h-100">
        <div id="language-switcher" class="d-flex justify-content-start p-2">
            <span class="flag active" data-lang="polish" title="Polski" data-i18n-tooltip="languagePolish">üáµüá±</span>
            <span class="flag" data-lang="english" title="English" data-i18n-tooltip="languageEnglish">EN</span>
            <span class="flag" data-lang="ukrainian" title="–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞" data-i18n-tooltip="languageUkrainian">üá∫üá¶</span>
        </div>

        <header class="d-flex justify-content-between align-items-center mb-3">
            <h6 class="m-0" id="welcome-message" data-i18n="welcome">
                <strong class="brand">KAMILA</strong> - Inteligentny Asystent <strong class="brand">DARWINA.PL</strong>
            </h6>
            
            <!-- Nowy komponent karty u≈ºytkownika -->
            <div class="user-card-flip">
                <div class="user-card-inner">
                    <div class="user-card-front">
                        <span class="user-name">-</span>
                    </div>
                    <div class="user-card-back">
                        <div class="qr-container">
                            <img src="" alt="QR Code" class="qr-code" />
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="row">
            <div class="col-2">
                <div class="store-selector mb-3">
                    <select id="store-select" class="kamila-form-select" data-i18n-placeholder="selectStore">
                        <!-- Lista sklep√≥w bƒôdzie generowana dynamicznie z stores.js -->
                    </select>
                </div>

                <div id="side-panel">
                    <div class="lead-status" data-status="1" data-bs-toggle="tooltip" data-i18n-tooltip="leadStatuses.submitted">
                        üì§ <span class="lead-count" id="count-1">-</span>
                    </div>
                    <div class="lead-status" data-status="2" data-bs-toggle="tooltip" data-i18n-tooltip="leadStatuses.confirmed">
                        ‚úÖ <span class="lead-count" id="count-2">-</span>
                    </div>
                    <div class="lead-status" data-status="3" data-bs-toggle="tooltip" data-i18n-tooltip="leadStatuses.accepted">
                        üì¶ <span class="lead-count" id="count-3">-</span>
                    </div>
                    <div class="lead-status" data-status="READY" data-bs-toggle="tooltip" data-i18n-tooltip="leadStatuses.ready">
                        üì¨ <span class="lead-count" id="count-ready">-</span>
                    </div>
                    <div class="lead-status" data-status="OVERDUE" data-bs-toggle="tooltip" data-i18n-tooltip="leadStatuses.overdue">
                        ‚è≥ <span class="lead-count" id="count-overdue">-</span>
                    </div>
                </div>
            </div>

            <div class="col-10">
                <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" 
                                id="chat-tab" 
                                data-bs-toggle="tab"
                                data-bs-target="#chat"
                                type="button" 
                                role="tab" 
                                aria-controls="chat" 
                                aria-selected="true" 
                                data-i18n="chat">Chat</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" 
                                id="settings-tab" 
                                data-bs-toggle="tab"
                                data-bs-target="#settings"
                                type="button" 
                                role="tab" 
                                aria-controls="settings" 
                                aria-selected="false" 
                                data-i18n="settings">Ustawienia</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" 
                                id="about-tab" 
                                data-bs-toggle="tab"
                                data-bs-target="#about"
                                type="button" 
                                role="tab" 
                                aria-controls="about" 
                                aria-selected="false" 
                                data-i18n="about">O aplikacji</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" 
                                id="status-tab" 
                                data-bs-toggle="tab"
                                data-bs-target="#status"
                                type="button" 
                                role="tab" 
                                aria-controls="status" 
                                aria-selected="false" 
                                data-i18n="status">Status</button>
                    </li>
                </ul>

                <div class="tab-content">
                    <div class="tab-pane fade show active" id="chat" role="tabpanel">
                        <div class="input-group">
                            <input 
                                type="text" 
                                id="query" 
                                class="input" 
                                data-i18n-placeholder="queryPlaceholder" 
                                placeholder="Wpisz swoje pytanie..."
                            >
                            <button 
                                id="send" 
                                class="button--submit" 
                                data-i18n="send" 
                                disabled
                            >Wy≈õlij</button>
                        </div>
                        
                        <!-- Komunikaty b≈Çƒôd√≥w i ≈Çadowania -->
                        <div class="messages mt-3">
                            <div class="error-message alert alert-danger d-none" data-i18n="errorEmptyQuery"></div>
                            <div class="error-message alert alert-danger d-none" data-i18n="errorConnection"></div>
                            <div class="loading-message alert alert-info d-none" data-i18n="loading"></div>
                        </div>
                        
                        <div id="response" class="mt-3"></div>
                    </div>

                    <div class="tab-pane fade" id="settings" role="tabpanel">
                        <h5 data-i18n="settings">Ustawienia</h5>
                        
                        <!-- Motyw -->
                        <div class="settings-section">
                            <h6 data-i18n="theme" id="theme-section-title">Motyw</h6>
                            <div class="theme-options">
                                <button data-theme="light" class="theme-btn">Jasny</button>
                                <button data-theme="dark" class="theme-btn">Ciemny</button>
                                <button data-theme="custom" class="theme-btn">W≈Çasny</button>
                            </div>
                        </div>
                        
                        <!-- Debug -->
                        <div class="settings-section">
                            <h6 data-i18n="debugTitle">Debug</h6>
                            <div class="kamila-form-check">
                                <input class="kamila-form-check-input" type="checkbox" id="debug-switch" checked>
                                <label class="form-check-label" for="debug-switch" data-i18n="debugMode">Tryb debugowania</label>
                            </div>
                        </div>
                        
                        <!-- T≈Ço -->
                        <div class="settings-section d-none">
                            <h6 data-i18n="background">T≈Ço</h6>
                            <div class="wallpaper-controls">
                                <div class="wallpaper-input-group disabled">
                                    <input type="file" id="wallpaper-input" accept="image/*" disabled>
                                    <label for="wallpaper-input" class="kamila-btn kamila-btn-outline" data-i18n="addCustomWallpaper" disabled>
                                        Dodaj w≈ÇasnƒÖ tapetƒô
                                    </label>
                                </div>
                                <div class="wallpaper-actions">
                                    <button id="remove-wallpaper" class="kamila-btn kamila-btn-danger" data-i18n="removeWallpaper" disabled>
                                        Usu≈Ñ t≈Ço
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Ustawienia u≈ºytkownika -->
                        <div class="settings-section mb-4">
                            <h6 data-i18n="userSettings">Ustawienia u≈ºytkownika</h6>
                            <div class="user-selector">
                                <label for="user-select" class="form-label" data-i18n="selectUser">Wybierz u≈ºytkownika:</label>
                                <select id="user-select" class="form-select form-select-sm">
                                    <option value="" data-i18n="noUserSelected">Wybierz u≈ºytkownika</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="tab-pane fade" id="about" role="tabpanel">
                        <h5 data-i18n="about">O aplikacji</h5>
                        <p data-i18n="creator">Tw√≥rca: Tomasz Wilk</p>
                        <p data-i18n="purpose">Cel: Automatyzacja proces√≥w obs≈Çugi klienta i zarzƒÖdzania zam√≥wieniami w DARWINA.PL</p>
                        <p id="version" data-i18n="version">Wersja: 1.0.0</p>
                        <div class="mt-3">
                            <button id="update-button" class="btn btn-success" data-i18n="checkUpdates">üöÄ Sprawd≈∫ aktualizacje</button>
                            <button id="instructions-button" class="btn btn-info ms-2" data-i18n="instructions">üìã Instrukcja</button>
                        </div>
                        <div id="instructions" class="mt-3 d-none"></div>
                    </div>

                    <div class="tab-pane fade" id="status" role="tabpanel">
                        <div class="p-3">
                            <h5 data-i18n="serviceStatus">Status us≈Çug</h5>
                            
                            <div class="status-section">
                                <!-- Lewa strona - kontrolki -->
                                <div class="status-controls">
                                    <div class="d-flex gap-2 mb-3">
                                        <button id="run-tests" class="btn btn-secondary" data-i18n="runTests">
                                            üîç Wykonaj testy
                                        </button>
                                        <button id="check-status" class="btn btn-primary" data-i18n="refreshStatus">
                                            üîÑ Od≈õwie≈º status
                                        </button>
                                    </div>

                                    <div class="services-status">
                                        <div class="service-item">
                                            <span class="status-dot" id="api-status"></span>
                                            <span class="service-name" data-i18n="apiSelly">API Selly</span>
                                        </div>
                                        <div class="service-item">
                                            <span class="status-dot" id="auth-status"></span>
                                            <span class="service-name" data-i18n="authorization">Autoryzacja</span>
                                        </div>
                                        <div class="service-item">
                                            <span class="status-dot" id="orders-status"></span>
                                            <span class="service-name" data-i18n="orders">Zam√≥wienia</span>
                                        </div>
                                        <div class="service-item">
                                            <span class="status-dot" id="cache-status"></span>
                                            <span class="service-name" data-i18n="cache">Cache</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Prawa strona - legenda -->
                                <div class="status-legend">
                                    <div class="legend-title" data-i18n="legend">Legenda status√≥w</div>
                                    <div class="legend-item">
                                        <span class="status-dot status-green"></span>
                                        <span data-i18n="statusOk">OK</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="status-dot status-yellow"></span>
                                        <span data-i18n="statusWarning">Ostrze≈ºenie</span>
                                    </div>
                                    <div class="legend-item">
                                        <span class="status-dot status-red"></span>
                                        <span data-i18n="statusError">B≈ÇƒÖd</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="leadDetailsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" data-i18n="leadDetails">Szczeg√≥≈Çy zam√≥wie≈Ñ</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="leadDetailsList"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="updateModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" data-i18n="updateAvailable">Dostƒôpna aktualizacja</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p data-i18n="updateVersionInfo">Dostƒôpna jest nowa wersja <strong id="updateVersion"></strong></p>
                    <div id="updateNotes" class="mt-3"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="kamila-btn kamila-btn-outline" id="cancelUpdate" data-i18n="cancel">Anuluj</button>
                    <button type="button" class="kamila-btn kamila-btn-primary" id="confirmUpdate" data-i18n="update">Aktualizuj</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="instructionsModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" data-i18n="instructionsTitle">Instrukcja aktualizacji</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <ol>
                        <li data-i18n="instructionUnzip">Rozpakuj pobrany plik ZIP</li>
                        <li data-i18n="instructionGoTo">Przejd≈∫ do chrome://extensions/</li>
                        <li data-i18n="instructionRemove">Usu≈Ñ obecnƒÖ wersjƒô Kamili</li>
                        <li data-i18n="instructionDevMode">W≈ÇƒÖcz tryb programisty</li>
                        <li data-i18n="instructionLoad">Kliknij "Za≈Çaduj rozpakowane"</li>
                        <li data-i18n="instructionSelect">Wska≈º folder z nowƒÖ wersjƒÖ</li>
                    </ol>
                </div>
                <div class="modal-footer">
                    <button type="button" class="kamila-btn kamila-btn-outline" data-bs-dismiss="modal" data-i18n="close">Zamknij</button>
                </div>
            </div>
        </div>
    </div>

    <div class="debug-panel">
        <div class="debug-header d-flex justify-content-between align-items-center">
            <span data-i18n="debugPanelTitle">Panel debugowania</span>
            <button id="clear-logs" class="kamila-btn kamila-btn-outline kamila-btn-sm" data-i18n="clear">Wyczy≈õƒá</button>
        </div>
        <div id="debug-logs" class="debug-content">
            <div class="log-entry log-empty" data-i18n="debugPanelEmpty">Brak log√≥w</div>
        </div>
    </div>

    <div id="orders-container" class="orders-container"></div>

    <!-- Custom theme panel -->
    <div class="custom-theme-panel" 
         role="dialog" 
         aria-labelledby="theme-panel-title"
         aria-modal="true"
         id="theme-panel"
         aria-live="polite">
        <h5 id="theme-panel-title" data-i18n="customTheme.title">Dostosuj motyw</h5>
        <div class="theme-controls">
            <!-- Colors -->
            <div class="control-group" role="group" aria-labelledby="colors-group-label">
                <label id="colors-group-label" data-i18n="customTheme.colors">Kolory g≈Ç√≥wne</label>
                <div class="color-inputs">
                    <div class="color-input">
                        <label for="primary-color" data-i18n="customTheme.primaryColor">Kolor podstawowy</label>
                        <input type="color" 
                               id="primary-color" 
                               name="primary"
                               aria-describedby="primary-color-desc">
                        <span id="primary-color-desc" class="visually-hidden">
                            Wybierz kolor podstawowy dla motywu
                        </span>
                    </div>
                    <div class="color-input">
                        <label for="secondary-color" data-i18n="customTheme.secondaryColor">Kolor dodatkowy</label>
                        <input type="color" 
                               id="secondary-color" 
                               name="secondary"
                               aria-describedby="secondary-color-desc">
                        <span id="secondary-color-desc" class="visually-hidden">
                            Wybierz kolor dodatkowy dla motywu
                        </span>
                    </div>
                </div>
            </div>
            
            <!-- Buttons -->
            <div class="panel-buttons" role="group" aria-label="Akcje motywu">
                <button id="reset-theme" 
                        class="kamila-btn kamila-btn-outline" 
                        data-i18n="actions.reset"
                        aria-label="Resetuj kolory do domy≈õlnych">Reset</button>
                <button id="save-theme" 
                        class="kamila-btn kamila-btn-primary" 
                        data-i18n="actions.save"
                        aria-label="Zapisz wybrane kolory">Zapisz</button>
            </div>
        </div>
    </div>

    <!-- Theme panel overlay -->
    <div id="theme-panel-overlay" class="theme-panel-overlay"></div>

    <script src="lib/bootstrap.bundle.min.js" defer></script>
    <script type="module" src="popup.js"></script>
</body>
</html>
